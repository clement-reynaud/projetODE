#pragma once
#include "terrain.h"
#include "projetODE.h"

double rdm[HFIELD_DSTEP][HFIELD_WSTEP];
extern dGeomID gheight;


int randFixed() {
	static int i=170;
	//fprintf(stderr, "randMax:%d\n", RAND_MAX);
	static int tab[1024] = {
		//ruby -e '(0..1023).each { |i| $stdout.write "#{rand(2147483647)}, "; }; puts'
		887646997, 215916600, 1104068186, 920295376, 1865636918, 1332439223, 1920879561, 297973620, 166525995, 1789326304, 867109497, 1448173413, 1545262672, 947619338, 2097687147, 753877238, 484783219, 1529412141, 561042554, 345004691, 1120609453, 1122360353, 1711556772, 55101519, 1853093431, 562353483, 1247287159, 361840113, 229567674, 1717937126, 11912024, 1842783610, 1936654352, 46644100, 1074146577, 979039738, 431477109, 1171575583, 822469924, 406548490, 1066301189, 123878275, 1331084659, 631332292, 232064213, 826403868, 413587603, 48504902, 314947018, 2023646332, 1644007541, 2104704589, 1535489546, 200653837, 1587540031, 1722214237, 1288042169, 1329425863, 1836061960, 849714129, 268715733, 1578670256, 81256013, 1457393243, 897301594, 700222927, 1055342847, 526226868, 1809417916, 752397754, 512103308, 1785795083, 1294038786, 147941224, 447423736, 539224402, 1621437778, 570039232, 1628836943, 1498831685, 1033725320, 539430011, 1198683585, 1986016528, 804031811, 2003973235, 1478858691, 1054718629, 1353232255, 1610749293, 1555799171, 55897346, 1734194444, 1978625982, 669060280, 2140344872, 1969878122, 1944546964, 496181747, 938828072, 2038930868, 1395367910, 282940317, 106729227, 24170039, 422797156, 271009634, 1686890509, 939236597, 661103783, 304391340, 2112004162, 802587954, 1553180729, 175500201, 934276106, 2002006664, 385062981, 1780166555, 191963043, 944150775, 25585267, 1850637726, 689841973, 905104618, 2014841991, 1611396598, 2143682783, 404767399, 1455441415, 1141727351, 1991576034, 2104535806, 1370488549, 422025610, 1725630843, 1528844726, 9147857, 1546347504, 2145993690, 1544505794, 1202946029, 1331174421, 671273711, 2046224441, 2139170218, 1074039847, 658119027, 431851531, 648040887, 1224074006, 1694461890, 1090840407, 1343644661, 1087944048, 197450595, 224487951, 1251607268, 399442301, 1286436330, 1784443423, 1630016096, 264652727, 1873222379, 1736233658, 1631055836, 666429083, 303954265, 81196923, 443407410, 1412221082, 7350676, 1234869499, 1870831787, 738264409, 855591892, 939525513, 2084163301, 1958232783, 2000485089, 1476655327, 260153329, 252282696, 1703586290, 1131228763, 2036887952, 944507325, 86648256, 360078037, 631129464, 1848218071, 1086869997, 605940496, 374203371, 855598561, 1333357912, 207246423, 199548781, 1771359066, 1392991915, 879042378, 497681764, 1913388851, 41439770, 570923716, 1169348528, 1605213586, 1310063077, 420505889, 1078834747, 423697953, 243234763, 1958781246, 1471397704, 116401939, 305234086, 568377718, 1896487843, 409956785, 800425104, 1494477149, 1770078104, 1479286083, 949843792, 1361244367, 404050513, 1569177378, 577430459, 984933123, 3980675, 1117314901, 626491403, 1168522779, 1893395783, 1722471454, 55353128, 1719459081, 246335802, 1474840691, 1715889691, 1721574564, 299354734, 1117658358, 354722360, 1096070011, 92788904, 1096524768, 328578432, 1562073781, 553290110, 528507837, 1981307929, 1209225178, 1578178459, 551692291, 2120800504, 2097786572, 442457997, 286371832, 1293263096, 247392227, 598361841, 1332335891, 1544487827, 1212417619, 1776791228, 751945887, 1622016827, 521338055, 234130914, 817635819, 1430647632, 918323798, 1333190233, 1261070678, 1663256476, 1566285687, 1588431830, 769418463, 1153763723, 1856782336, 1967693789, 1529552350, 991443646, 694674125, 2086196206, 821147609, 589204135, 969282757, 1188101234, 123843641, 1702408480, 1929412812, 1246874828, 1198084488, 1981897017, 865800477, 1374512064, 1769923049, 1489023283, 238094094, 1460277646, 1511094755, 723175604, 1349194841, 1360731628, 2006484821, 1792607532, 1269274670, 1358602816, 45089814, 2079052606, 336830944, 1254483148, 565317533, 395967805, 419384228, 582510302, 1275455523, 920184338, 311536092, 920209636, 1775233401, 1571357624, 990890084, 697992896, 1492171298, 650118207, 1280454361, 1334343735, 396290979, 689989992, 744635861, 1853130311, 1554498993, 1393241934, 220601546, 1582634221, 2014407617, 286505351, 1010789931, 1334138744, 40073950, 65358194, 470425385, 1882137189, 1524175236, 1247833763, 819462028, 1338881378, 361250342, 2096019605, 943097826, 1119992611, 1852422109, 1668461545, 1022638853, 1217665274, 868975715, 836074965, 1019291643, 1335956953, 359876353, 893270005, 1376939959, 2133819308, 629238107, 396317835, 1680242166, 1802241992, 380110638, 928841056, 1476845923, 986029297, 552304755, 772656956, 383216738, 1506044616, 337509182, 1858707436, 1067538543, 1110790836, 1492653071, 473532009, 852794890, 595598347, 2079364378, 1877000919, 695513477, 1317784146, 300604237, 1518028100, 1876544811, 108748341, 884999739, 1119492990, 968348789, 130668136, 1962685110, 1439276195, 587776369, 645817110, 2065826815, 840572899, 1894547897, 876956402, 1682726915, 11982915, 1891560766, 372956607, 177938102, 1717346044, 362085767, 901972744, 1883668276, 1910685738, 50257771, 1293602554, 1762805161, 193310341, 1648412846, 590167359, 994607823, 1420451881, 999250552, 323967006, 1593364563, 1797123546, 1067405894, 788166914, 1295185822, 46528921, 746047858, 1527062549, 784207352, 786538218, 91995597, 609530991, 1746373052, 90864772, 440221866, 845678524, 670372708, 236032588, 765067596, 877956338, 2139491807, 778301403, 791628925, 1156467070, 1364783159, 2067150655, 118523844, 2123074371, 57259760, 1148187066, 666314527, 89188498, 1225063259, 1236955236, 949494567, 1294499770, 1304314213, 662069365, 1658843725, 1075885896, 279266225, 1060722184, 24682029, 1540493435, 240780720, 952890328, 1028735496, 1284063282, 2003782194, 934778013, 2071989497, 1276292584, 308416874, 1504891709, 456601315, 1094337926, 1595163230, 26361155, 451940242, 310339702, 694019992, 1878671530, 371675639, 1396088849, 2086930863, 1918847581, 406321246, 1963931677, 1578459749, 1422964861, 2035973836, 1013773553, 1797941720, 1038793291, 1470666649, 505939274, 1744011731, 1859399181, 2063749460, 151548894, 947125399, 1646860776, 1711288820, 1003337332, 6038001, 1206422488, 1081462943, 165308177, 317785626, 1455862803, 268128320, 1334005178, 2115307925, 856666502, 494309922, 1728361003, 156156167, 111014902, 775904302, 1049835547, 326395871, 1999933986, 250948670, 1524702521, 1653464809, 1727179889, 87711454, 458051901, 1871006262, 1343480438, 761420951, 620230003, 1649497697, 780443057, 2068908424, 499317743, 592139516, 445904193, 1341614748, 1736610176, 149893512, 1344020135, 2049466275, 1927815716, 235753419, 967242716, 427926825, 1652182700, 526628358, 991468989, 1463317305, 349324765, 147889503, 1417200161, 1755949588, 461784090, 540511273, 1217450193, 948595687, 1168046889, 330842122, 191588501, 1922950798, 321800118, 956031411, 1609761792, 1020719731, 175078379, 1055994314, 780525357, 2075329852, 623790605, 446264331, 98323666, 1920802083, 763512287, 1160354914, 1966656266, 914551205, 992479324, 823548076, 404736306, 410809716, 150187912, 762614109, 2107115168, 339243182, 1167511975, 2015789301, 416162277, 1983040329, 595531323, 1552729785, 1444452218, 1272995862, 428048011, 1001752171, 1409340502, 577274171, 1608594967, 31159881, 2036274595, 295077799, 171128893, 711488401, 734797192, 1863006966, 868344757, 1285988236, 1918495600, 142825213, 755132510, 1222887291, 1305101260, 880675431, 1944943653, 1254097691, 579524717, 2002774538, 859744603, 491252275, 199414143, 1507290435, 1465877378, 986574877, 2049234979, 2092715048, 1391992622, 1990745340, 1783025323, 396365011, 1838723307, 194539819, 389660992, 1671146596, 1703747029, 776622226, 944139786, 234486215, 361688597, 1379846629, 1873499585, 1879231144, 1087579088, 970602294, 793876910, 27089180, 1494784024, 2089960375, 1203954420, 800136387, 857757659, 1029436104, 403733479, 1291889000, 1210034594, 2053444041, 408919927, 95187125, 871367903, 1812730050, 937922572, 292436754, 1751663454, 2106680922, 1519159540, 399883775, 1477623999, 1649293336, 1487251754, 899502867, 1610919653, 1189243440, 1567761304, 1050202378, 1859567541, 2064742873, 504358994, 1940662911, 751911314, 1006230859, 672881612, 1517917431, 2115419052, 1939907761, 1197028745, 425579345, 1709213951, 1231473172, 2058359418, 171443942, 264474751, 1462139918, 1506310170, 2038507823, 951167497, 965408154, 1587706959, 298132516, 1046351147, 1546068821, 1323128005, 1549807559, 1909001413, 1460097958, 496703138, 1155871270, 1159501143, 403136126, 1757912290, 183499532, 1761815327, 891661413, 1304253860, 8230199, 37344229, 354237220, 907340213, 197501124, 1361871884, 1296302439, 1676480564, 482096178, 800563198, 300893661, 352838288, 660398964, 214920611, 1715342320, 1025536415, 1899703815, 558989352, 2040999163, 2052553136, 1613094866, 1928729756, 331252603, 1577653967, 412909556, 1202918842, 1003556033, 826448996, 187211808, 314866719, 213759849, 559314019, 354005931, 208123297, 1017179753, 337455317, 1039519803, 776185778, 1721884682, 1442780368, 600099110, 2062236889, 620054879, 1967128822, 380395173, 647430257, 214504924, 981771926, 383234502, 1907745433, 413389011, 966085759, 613779594, 16622553, 4286919, 601323479, 1204854235, 1788326023, 1990016274, 1323939025, 1275026540, 511509894, 444470980, 128689680, 1385413777, 880100508, 107157158, 1168333037, 1317142227, 1153744879, 1725526060, 1317525898, 330972084, 757571692, 435613119, 943743870, 35483295, 753231832, 1716314394, 1785419537, 388226189, 1358989519, 1768084675, 603075786, 735097850, 1959950357, 1393750112, 1634620398, 365152739, 964094242, 516032120, 1024219595, 1009265235, 37073930, 2073129399, 1837656459, 2138482716, 1373392728, 969956408, 915747813, 1190928382, 1075207919, 470317096, 2103207035, 1717770235, 1192586695, 1191549823, 1673877300, 104917596, 391463983, 1537732550, 501465131, 426781166, 553265968, 258622029, 899010848, 846330495, 1492033774, 1841092225, 1602761681, 1072474894, 913392236, 146042677, 1554307128, 308894769, 963144692, 634108087, 473842676, 720553288, 1761206132, 1820472182, 156162777, 36932318, 1774336354, 715544577, 1633541393, 127837002, 773848819, 1522848550, 315039869, 665749050, 560871305, 471357744, 1153234517, 1409456137, 1648458037, 235417021, 1137666351, 1045131977, 1714616023, 1713519912, 975039310, 1238117612, 811860820, 1910126418, 1894523388, 1377400804, 813640066, 42097826, 2027367232, 2146003369, 1275975502, 524632139, 911698332, 2117302098, 929097259, 456400943, 16082429, 100312240, 1707756158, 1947801767, 969372398, 843400765, 174685881, 1348827820, 195154772, 1103608766, 916655192, 1746242481, 1583187588, 913512537, 1930802899, 1194261340, 388955107, 595471349, 946303058, 1106911878, 1245440033, 1013658671, 1180881463, 1310766441, 393209436, 1148029335, 1792978683, 1153448261, 1464147447, 1459636933, 1792529164, 2021495896, 1323422154, 1274388782, 2005479613, 581437245, 667900435, 1674020952, 91068143, 1454966399, 1332524149, 1623617601, 564098895, 1059547690, 1581393455, 2035388190, 2123685997, 842279252, 1986988927, 445571178, 2138179075, 1855338373, 963432265, 901859089, 1021843229, 1010266181, 1428062981, 1621371414, 1604700809, 58862987, 1545824435, 1327996785, 654468140, 1159172722, 1196411968, 1765810164, 1655671286, 23945476, 1001648798, 1330399460, 94853322, 137963801, 1706187143, 762740024, 1879569884, 1962150018, 381013622, 212811099, 1933947616, 1323282583, 1627048752, 1941784368, 906080324, 132183841, 1291590201, 1405498086, 579437436, 669287322, 510614799, 283303327, 1382912631, 1405584724, 1811443526, 1306353705, 1825254011, 1910497653, 1811370270, 991488245, 596993321, 312349909, 2097913804, 707425363, 367930509, 203349783, 400535567, 534810924, 590601001, 182991455, 1260684683, 1163981765, 1761340904, 1757845428, 1426671046, 992587568, 1466011475, 1061249556, 2121882034, 1830746480, 16063952, 1377034197, 642246356, 1591547675, 2118833907, 1789873487, 429945592, 2125907668, 1441191253, 393384244, 350737197, 2097899145, 913634315, 308592474, 541068047, 1502556683, 1151507822, 2074272558, 1313898716,
	};
	
	int n=tab[i];
	i=(i+1)%1024;
	return n;
}

float RandomFloat(float min, float max) {
    return  (max - min) * ((((float)randFixed()) / (float)RAND_MAX)) + min;
}

void initTerrain(void) {
    int tmp[60][60] =
    {
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0,
       0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    };

    for (int i = 0; i < HFIELD_DSTEP; i++) {
        for (int j = 0; j < HFIELD_WSTEP; j++) {

            int roadHeight = -1;
            
            if (tmp[i][j] == 0) {
                rdm[i][j] = roadHeight;
            }
            else {
                rdm[i][j] = RandomFloat (-2, 4);
            }
        }
    }
}

dReal heightfield_callback(void*, int x, int z)
{
    return rdm[x][z];
}

void drawHFieldGeom(dGeomID g, const dReal* pos, const dReal* R, int show_aabb)
{
    if (!g)
        return;
    if (!pos)
        pos = dGeomGetPosition(g);
    if (!R)
        R = dGeomGetRotation(g);

    int type = dGeomGetClass(g);
    if (type == dHeightfieldClass) {

        // Set ox and oz to zero for DHEIGHTFIELD_CORNER_ORIGIN mode.
        int ox = (int)(-HFIELD_WIDTH / 2);
        int oz = (int)(-HFIELD_DEPTH / 2);

        //	for ( int tx = -1; tx < 2; ++tx )
        //	for ( int tz = -1; tz < 2; ++tz )
        dsSetColorAlpha(250/255.0, 120/255.0, 20/255.0, 1);
        
        dsSetTexture(DS_WOOD);

        for (int i = 0; i < HFIELD_WSTEP - 1; ++i)
            for (int j = 0; j < HFIELD_DSTEP - 1; ++j) {
                dReal a[3], b[3], c[3], d[3];

                a[0] = ox + (i)*HFIELD_WSAMP;
                a[1] = heightfield_callback(NULL, i, j);
                a[2] = oz + (j)*HFIELD_DSAMP;

                b[0] = ox + (i + 1) * HFIELD_WSAMP;
                b[1] = heightfield_callback(NULL, i + 1, j);
                b[2] = oz + (j)*HFIELD_DSAMP;

                c[0] = ox + (i)*HFIELD_WSAMP;
                c[1] = heightfield_callback(NULL, i, j + 1);
                c[2] = oz + (j + 1) * HFIELD_DSAMP;

                d[0] = ox + (i + 1) * HFIELD_WSAMP;
                d[1] = heightfield_callback(NULL, i + 1, j + 1);
                d[2] = oz + (j + 1) * HFIELD_DSAMP;

                dsDrawTriangle(pos, R, a, c, b, 1);
                dsDrawTriangle(pos, R, b, c, d, 1);
            }

    }
}

void createHField(dSpaceID space) {
    // our heightfield floor

    dHeightfieldDataID heightid = dGeomHeightfieldDataCreate();

    // Create an finite heightfield.
    dGeomHeightfieldDataBuildCallback(heightid, NULL, heightfield_callback,
        HFIELD_WIDTH, HFIELD_DEPTH, HFIELD_WSTEP, HFIELD_DSTEP,
        REAL(1.0), REAL(0.0), REAL(0.0), 0);

    // Give some very bounds which, while conservative,
    // makes AABB computation more accurate than +/-INF.
    dGeomHeightfieldDataSetBounds(heightid, REAL(-4.0), REAL(+6.0));

    gheight = dCreateHeightfield(space, heightid, 1);
    dGeomSetData(gheight,(void *)G_GROUND);

    dVector3 pos;
    pos[0] = 0;
    pos[1] = 0;
    pos[2] = 0;

    // Rotate so Z is up, not Y (which is the default orientation)
    dMatrix3 R;
    dRSetIdentity(R);
    dRFromAxisAndAngle(R, 1, 0, 0, DEGTORAD * 90);

    // Place it.
    dGeomSetRotation(gheight, R);
    dGeomSetPosition(gheight, pos[0], pos[1], pos[2]);
}

dGeomID getHField(void) { return gheight; }
